<!DOCTYPE html>
<html lang="en">

<head>
    <!-- Etiquetas meta -->
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="keywords" content="">
    <meta name="description" content="">

    <!-- Título de la página-->
    <title>Mi cuenta</title>
    <!--------------------------- Conexiones para Estilos------------------------->

    <!-- Conexión con BootStrap -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH" crossorigin="anonymous">
    
    <!--Conexión Iconos BootStrap-->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.min.css">

    <!--Conexión Tipografía Darker Grotesque-->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Darker+Grotesque:wght@300..900&display=swap" rel="stylesheet">
    
    <!--Conexión Tipografía Open Sans-->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Darker+Grotesque:wght@300&family=Open+Sans:ital@0;1&display=swap" rel="stylesheet">

    <!--Conexión Styles-->
    <link rel="stylesheet" href="../styles/style-navbar-footer-body.css">
    <link rel="stylesheet" href="../styles/style-configuración-usuario.css">
    <link rel="stylesheet" href="../styles/contactanos-styles.css">


</head>
 <!--------------------------------------- Inicia el Header ------------------------------------------->
<header>
  <div id="navbar-placeholder"></div>

  <script>
    document.addEventListener("DOMContentLoaded", function() {
      fetch('./navbar.html')
        .then(response => response.text())
        .then(data => {
          document.getElementById('navbar-placeholder').innerHTML = data;
        });
    });
  </script>
  
<!-------------------------------------- Termina la NavBar ----------------------------------->
  </header>
<!------------------------------- Termina el Header --------------------------------------------------------------->

   
<!-------------------------------------------------- Inicia el Body ------------------------------------------------>

  <body class="body-style">

    <!-------------------------------- Empieza el contenedor de la página ----------------------------------------------------------->
    
    <div class="wrapper">
        <aside id="sidebar">
            <div class="d-flex">
                <button id="toggle-btn" type="button">
                    <i class="bi bi-person-vcard-fill"  onclick="mostrarFormulario('opciones-cuenta')"></i>
                </button>
                <div class="sidebar-logo">
                    <a href="#" class="sidebar-link" onclick="mostrarFormulario('opciones-cuenta')">Mi cuenta</a>
                </div>
            </div>
            <ul class="sidebar-nav">
                <li class="sidebar-item">
                    <a href="#" class="sidebar-link" onclick="mostrarFormulario('opciones-editarCuenta')">
                        <i class="bi bi-gear"></i>
                        <span>Configuración</span>
                    </a>
                </li>
                <li class="sidebar-item">
                    <a href="#" class="sidebar-link" onclick="mostrarFormulario('direcciones-envio')">
                        <i class="bi bi-geo-alt-fill"></i>
                        <span>Direcciones</span>
                    </a>
                </li>
                <li class="sidebar-item">
                    <a href="#" class="sidebar-link" onclick="mostrarFormulario('opciones-pago')">
                        <i class="bi bi-credit-card-fill"></i>
                        <span>Métodos de pago</span>
                    </a>
                </li>
                
           </ul>
        </aside>
    
        <div class="main p-3">
    
          <div class="contenido" id="contenido">
    
    
            <!-- Este div contiene las opciones de cuenta y tiene la clase 'formulario' -->
            <div id="opciones-cuenta" class="formulario" style="display: block;">
            
    
              <div class="account-details" id="miCuenta">
                <h4>Mi cuenta</h4>
                <br>
                <p>Nombre:  <span id="name"> </span></p>
                <hr>
                <p>Apellido paterno:  <span id="lastnameDad"></span></p>
                <hr>
                <p>Apellido materno:  <span id="lastnameMom"></span></p>
                <hr>
                <p>Correo:  <span id="email"></span></p>
                <hr>
                <p>Número de teléfono:  <span id="num"></span></p>
                <hr>
                <p>Contraseña:  <span id="password"></span></p>
                <hr>
              </div>
            </div>
            
            
            <div id="opciones-editarCuenta" class="formulario" style="display: none;">
                <h4>Detalles de cuenta</h4>
                <div id="accountInfo">
                  <!-- Detalles de la cuenta se mostrarán aquí -->
                </div>
              
                <button class="ButtonsConfig" onclick="openFormCuenta()">Editar Cuenta</button>
              
                <!-- Formulario para editar datos de la cuenta -->
                <div id="editForm" class="form-popup" style="display: none;">
                  <form id="editFormContent" class="form-container">
                    <h4>Editar Mi cuenta</h4>
                    <label for="firstName">Nombre:</label>
                    <input type="text" id="firstName" required><br>
                    <label for="middleName">Apellido paterno:</label>
                    <input type="text" id="middleName"><br>
                    <label for="lastName">Apellido materno:</label>
                    <input type="text" id="lastName" required><br>
                    <label for="email">Correo:</label>
                    <input type="email" id="email" readonly placeholder="Este campo no se puede modificar"><br>
                    <label for="tel">Número de teléfono:</label>
                    <input type="number" id="tel" required><br>
                    <button type="button" class="ButtonsConfig" onclick="togglePasswordFields()">Editar Contraseña</button><br><br>
                    <div id="passwordFields">
                    <label for="pwd">Nueva contraseña:</label>
                    <input type="password" id="pwd" name="pwd" placeholder="Introduce la nueva contraseña"><br><br>
                    <label for="confirmPassword">Confirmar Contraseña:</label>
                    <input type="password" id="confirmPassword" name="confirmPassword" placeholder="Confirma la contraseña" required><br><br>
                    </div>
                    <button type="button" class="ButtonsConfig" onclick="saveChanges()">Guardar</button>
                    <button type="button" class="ButtonsConfig" onclick="closeFormCuenta()">Cancelar</button>
                  </form>
                </div>
              </div>
            
            
            <!-- Este div contiene las opciones de pago y tiene la clase 'formulario' -->
            <div id="opciones-pago" class="formulario" style="display: none;">
              <h4>Tarjetas</h4>
              <div id="cardList">
                <!-- Tarjetas se agregarán dinámicamente aquí -->
              </div>
            
              <button class="ButtonsConfig" onclick="openFormCards()">Agregar tarjeta</button>
            
              <!-- Formulario para agregar/editar tarjetas -->
              <div id="cardForm" class="form-popup" style="display: none;">
                <form id="cardFormContent" class="form-container">
                  <h4>Agregar/Editar tarjeta</h4>

                  <label for="cardNumber">Número de tarjeta:</label>
                  <input type="text" id="cardNumber" placeholder="XXXX-XXXX-XXXX-XXXX" maxlength="16" pattern="\d{16}" name="cardNumber" oninput="detectCompanyAndBank()"><br>

                  <label for="cardOwner">Nombre del propietario:</label>
                  <input type="text" id="cardOwner" name="cardOwner"required><br>

                  <label for="expiryDate">Fecha de expiración:</label>
                  <input type="text" id="expiryDate" placeholder="MM/AA" maxlength="4" minlength="4"required><br>

                  <label for="securityCode">Código de seguridad:</label>
                  <input type="text" id="securityCode"  name="securityCode" maxlength="4" minlength="3" placeholder="CVV" required><br>

                  <label for="company">Compañía:</label>
                  <input type="text" id="company" name="company" readonly><br>

                  <label for="bank">Banco:</label>
                  <input type="text" id="bank" name="bank" readonly><br>

                  <!-- Radio buttons para seleccionar el tipo de tarjeta -->
                  <label>Tipo de tarjeta:</label><br>
                  <input type="radio" id="credit" name="cardType" value="Crédito">
                  <label class="content-input" for="credit">Crédito</label><br>
                  <input type="radio" id="debit" name="cardType" value="Débito" checked>
                  <label class="content-input" for="debit">Débito</label><br>

                  <button type="button" id="guardar-tarjeta" class="ButtonsConfig" onclick="saveCard()">Guardar</button>
                  <button type="button" class="ButtonsConfig" onclick="closeFormCards()">Cancelar</button>
                </form>
              </div>
            </div>
            

            <!-- Este div contiene el formulario de direcciones de envío y tiene la clase 'formulario' -->
            <div id="direcciones-envio" class="formulario" style="display: none;">
              <h4>Direcciones</h4>
    
              <div id="addressList">
                <!-- Direcciones se agregarán dinámicamente aquí -->
              </div>
            
              <button class="ButtonsConfig" onclick="openFormAddresses()">Añadir dirección</button>
            
              <!-- Formulario para agregar/editar direcciones -->
              <div id="addressForm" class="form-popup" style="display: none;">
                <form id="addressFormContent" class="form-container">
                  <h4>Agregar/Editar dirección</h4>

                  <label for="fullName">Nombre completo:</label>
                  <input type="text" id="fullName" required><br>

                  <label for="street">Calle:</label>
                  <input type="text" id="street"  autocomplete="street-address"  required><br>

                  <label for="number">Número interior:</label>
                  <input type="number" id="numberInt" required><br>

                  <label for="number">Número exterior:</label>
                  <input type="number" id="numberExt" required><br>

                  <label for="postalCode">Código Postal:</label>
                  <input type="text" id="postalCode" onblur="fetchPostalCodeInfo()" required><br>

                  <label for="neighborhood">Colonia:</label>
                  <select name="neighborhood" id="neighborhood" required></select><br>

                  <label for="city">Municipio:</label>
                  <input type="text" id="municipio" required ><br>

                  <label for="city">Ciudad:</label>
                  <input type="text" id="city" required ><br>

                  <label for="state">Estado:</label>
                  <input type="text" id="state" required ><br>
                    

                  <label for="country">País:</label>
                  <input type="text" id="country" value="México" readonly required><br>

                  <button type="button" id = "guardar-direccion" class="ButtonsConfig" onclick="saveAddress()">Guardar</button>
                  <button type="button" class="ButtonsConfig" onclick="closeFormAddresses()">Cancelar</button>
                </form>
              </div>

              <!--<div id="errorMessage"  style="display: none; color: red;">
                No se encontraron detalles para el código postal ingresado.
              </div>-->
                
            </div>
    
            <!-- Contenedor de la alerta de BootStrap-->
            <div class="alert alert-success mt-3 alert-dismissible fade show" role="alert" id="alerta-success" style="display: none;">
              <i class="bi bi-check-circle-fill" style="color: green;"></i> 
              Los cambios se guardaron correctamente.
              <!--<button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Cerrar">
              </button>-->
          </div>
          <!-- Contenedor de la alerta de BootStrap-->
          <div class="alert alert-danger mt-3 alert-dismissible fade show" role="alert" id="alerta-danger" style="display: none;">
            <i class="bi bi-exclamation-triangle-fill" style="color: red; align-items: center; justify-content: center;"></i> 
            La contraseña no coincidió. Por favor, confirme su nueva contraseña.
            <button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Cerrar">
            </button>
          </div>
           <!-- Contenedor de la alerta de BootStrap-->
           <div class="alert alert-danger mt-3 alert-dismissible fade show" role="alert" id="alerta-dangerCampos" style="display: none;">
            <i class="bi bi-exclamation-triangle-fill" style="color: red; align-items: center; justify-content: center;"></i> 
            Por favor llene todos los campos.
            <!--<button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Cerrar">
            </button>-->
          </div>
           <!-- Contenedor de la alerta de BootStrap-->
          <div class="alert alert-danger mt-3 alert-dismissible fade show" role="alert" id="alerta-dangerContra" style="display: none;">
            <i class="bi bi-exclamation-triangle-fill" style="color: red; align-items: center; justify-content: center;"></i> 
            El campo de contraseña no puede estar vacío y debe de tener al menos una letra minúscula, una letra mayúscula, un dígito, un carácter especial y un mínimo de 8 caracteres.
           <!---- <button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Cerrar">
            </button>-->
          </div>

          <!-- Contenedor de la alerta de BootStrap-->
           <div class="alert alert-danger mt-3 alert-dismissible fade show" role="alert" id="alerta-dangerNameApellidos" style="display: none;">
          <i class="bi bi-exclamation-triangle-fill" style="color: red; align-items: center; justify-content: center;"></i> 
            Los campos de Nombre y apellidos no pueden estar vacíos y no aceptan carácteres numéricos.
           <!---- <button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Cerrar">
            </button>-->
          </div>

            <!-- Contenedor de la alerta de BootStrap-->
            <div class="alert alert-danger mt-3 alert-dismissible fade show" role="alert" id="alerta-dangerNumber" style="display: none;">
              <i class="bi bi-exclamation-triangle-fill" style="color: red; align-items: center; justify-content: center;"></i> 
                El campo de añadir teléfono no puede estar vacío y solo puede contener 10 carácteres numéricos.
               <!---- <button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Cerrar">
                </button>-->
            </div>
           <!-- Contenedor de la alerta de BootStrap-->
           <div class="alert alert-danger mt-3 alert-dismissible fade show" role="alert" id="alerta-dangerCard" style="display: none;">
            <i class="bi bi-exclamation-triangle-fill" style="color: red; align-items: center; justify-content: center;"></i> 
              El campo de añadir tarjeta no puede estar vacío y tiene que contener 16 carácteres numéricos.
             <!---- <button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Cerrar">
              </button>-->
          </div>

          <!-- Contenedor de la alerta de BootStrap-->
          <div class="alert alert-danger mt-3 alert-dismissible fade show" role="alert" id="alerta-dangerExpiryDate" style="display: none;">
            <i class="bi bi-exclamation-triangle-fill" style="color: red; align-items: center; justify-content: center;"></i> 
              El campo de expiración de la tarjeta no puede estar vacío y tiene que contener 4 carácteres numéricos.
             <!---- <button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Cerrar">
              </button>-->
          </div>

          <!-- Contenedor de la alerta de BootStrap-->
          <div class="alert alert-danger mt-3 alert-dismissible fade show" role="alert" id="alerta-dangerCVV" style="display: none;">
            <i class="bi bi-exclamation-triangle-fill" style="color: red; align-items: center; justify-content: center;"></i> 
              El campo de CVV no puede estar vacío y tiene que contener mínimo 3 carácteres numéricos.
             <!---- <button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Cerrar">
              </button>-->
          </div>

           <!-- Contenedor de la alerta de BootStrap-->
           <div class="alert alert-danger mt-3 alert-dismissible fade show" role="alert" id="errorMessageCP" style="display: none;">
            <i class="bi bi-exclamation-triangle-fill" style="color: red; align-items: center; justify-content: center;"></i> 
              No se encontraron detalles para el código postal ingresado.
             <!---- <button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Cerrar">
              </button>-->
          </div>
   </div>
     </div>

     </div>
    </div>
    </div>
    
  <!------------------------------------- Termina el contenedor de la página ----------------------------------------------------------->
    

 <!---------------------------------------------Inicio de Footer----------------------------------------------------->

 <footer class="text-center text-lg-start text-white" style="background-color: #696868 ">
  <div id="footer-script"></div>
  <script>
      document.addEventListener("DOMContentLoaded", function () {
          fetch('./footer.html')
              .then(response => response.text())
              .then(data => {
                  document.getElementById('footer-script').innerHTML = data;
              });
      });
  </script>
</footer>
<!-- Fin del Footer -->

<!-- Scripts -->
<script src="../scripts/script-configuración-usuario.js"></script>
<script src="../scripts/configuracion-usuarioApi.js"></script>
<!-- Conexión con jQuery -->
<script src="//ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
<script src="https://code.jquery.com/jquery-3.6.0.min.js" integrity="sha384-KyZXEAg3QhqLMpG8r+Knujsl5+z5KA9QF1c8EIf+6cv8LfCW2x4EBY2F/vMHZ5ISK" crossorigin="anonymous"></script>
<!-- Conexión con BootStrap -->
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js" integrity="sha384-YvpcrYf0tY3lHB60NNkmXc5s9fDVZLESaAA55NDzOxhy9GkcIdslK1eN7N6jIeHz" crossorigin="anonymous"></script>
<!-- Otros scripts -->
<script src="https://smtpjs.com/v3/smtp.js"></script>
<script>
  $(document).ready(function(){
    $('.dropdown-toggle').dropdown();
  });
</script>
</body>
<!----------------------------------------------- Termina el Body --------------------------------------------->
</html>